<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>atlas based segmentation | Frederik Hartmann</title> <meta name="author" content="Frederik Hartmann"> <meta name="description" content="A Hybrid Approach for Brain Tissue Segmentation - Integrating Gaussian Mixture Models with Atlas-based and Tissue Modeling Techniques"> <meta name="keywords" content="Frederik, Hartmann"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://frederik-hartmann.github.io/projects/atlasSegmentation/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Frederik </span>Hartmann</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">atlas based segmentation</h1> <p class="post-description">A Hybrid Approach for Brain Tissue Segmentation - Integrating Gaussian Mixture Models with Atlas-based and Tissue Modeling Techniques</p> </header> <article> <hr> <p>Authors: <a href="https://github.com/Frederik-Hartmann" rel="external nofollow noopener" target="_blank">Frederik Hartmann</a>, <a href="https://xavibeltranurbano.github.io/" rel="external nofollow noopener" target="_blank">Xavier Beltran Urbano</a> <br> Code: <a href="https://github.com/Frederik-Hartmann/Atlas-Based-Brain-Tissue-Segmentation" rel="external nofollow noopener" target="_blank">Github</a> <br> Report: <a href="https://github.com/Frederik-Hartmann/Atlas-Based-Brain-Tissue-Segmentation/blob/main/Report/LAB3_Report.pdf" rel="external nofollow noopener" target="_blank">Github</a></p> <p>*This project was carried out within the scope of the Medical Image Segmentation course taught by <a href="http://atc.udg.edu/~llado/" rel="external nofollow noopener" target="_blank">Prof. Dr. Xavier Lladó</a>.</p> <p>November 2023</p> <hr> <hr> <h2 id="dataset">Dataset</h2> <p>The dataset used for this laboratory contains 20 cases, each with a T1-weighted scan and a ground truth (GT) consisting of segmentation masks for white matter (WM), grey matter (GM), and cerebrospinal fluid (CSF). A registration step was performed prior to the segmentation to register the atlas, i.e., the mean image, to the target.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/projectImages/atlasSegmentation/dataset-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/projectImages/atlasSegmentation/dataset-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/projectImages/atlasSegmentation/dataset-1400.webp"></source> <img src="/assets/projectImages/atlasSegmentation/dataset.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Example of the different modalities of the dataset" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig.1. Example of the different modalities of the dataset. A) T1-weighted C) GT </div> <h2 id="methodology">Methodology</h2> <p>Our approach involved a hybrid technique integrating Gaussian Mixture Models (GMM) with Atlas-based and Tissue Modeling techniques. The methodology encompassed various stages:</p> <ol> <li> <strong>Atlas Registration</strong>: Employing a multi-step registration process using rigid, affine, and multi-resolution b-spline registration.</li> <li> <strong>Segmentation Techniques</strong>: We experimented with segmentation using tissue models, probabilistic atlas, and combinations of both, with and without GMM. We also explored different GMM initialization methods and integration of the probabilistic atlas at various stages of the process.</li> </ol> <h2 id="results">Results</h2> <p>The effectiveness of the methods was evaluated using the Dice Score and Balanced Accuracy metrics. We found that the combination of tissue models and probabilistic atlas yielded the best results. Below are detailed tables of our findings:</p> <h3 id="results-of-different-segmentation-approaches-without-using-gmm-algorithm">Results of Different Segmentation Approaches without Using GMM Algorithm</h3> <table border="1"> <tr> <th>Initialization</th> <th>CSF (Dice: mean ± std)</th> <th>WM (Dice: mean ± std)</th> <th>GM (Dice: mean ± std)</th> <th>BA (mean ± std)</th> <th>Time [s] (mean ± std)</th> </tr> <tr> <td>Tissue Models</td> <td>0.247 ± 0.164</td> <td>0.780 ± 0.087</td> <td>0.816 ± 0.111</td> <td>0.614 ± 0.100</td> <td><strong>0.644 ± 0.101</strong></td> </tr> <tr> <td>Probabilistic Atlas</td> <td>0.790 ± 0.055</td> <td>0.846 ± 0.015</td> <td>0.771 ± 0.019</td> <td>0.802 ± 0.025</td> <td>1.478 ± 0.531</td> </tr> <tr> <td>Combination of Both</td> <td><strong>0.856 ± 0.050</strong></td> <td><strong>0.915 ± 0.012</strong></td> <td><strong>0.867 ± 0.018</strong></td> <td><strong>0.879 ± 0.021</strong></td> <td>108.320 ± 19.230</td> </tr> </table> <h3 id="results-of-different-initialization-types">Results of Different Initialization Types</h3> <table border="1"> <tr> <th>Initialization</th> <th>CSF (Dice: mean ± std)</th> <th>WM (Dice: mean ± std)</th> <th>GM (Dice: mean ± std)</th> <th>BA (mean ± std)</th> <th>Time [s] (mean ± std)</th> </tr> <tr> <td>K-means</td> <td>0.196 ± 0.289</td> <td><strong>0.879 ± 0.089</strong></td> <td>0.792 ± 0.053</td> <td>0.703 ± 0.106</td> <td>40.163 ± 21.664</td> </tr> <tr> <td>Tissue Model</td> <td>0.300 ± 0.313</td> <td>0.854 ± 0.096</td> <td>0.839 ± 0.049</td> <td><strong>0.746 ± 0.087</strong></td> <td><strong>18.277 ± 14.510</strong></td> </tr> <tr> <td>Probabilistic Atlas</td> <td><strong>0.307 ± 0.319</strong></td> <td>0.831 ± 0.108</td> <td><strong>0.840 ± 0.044</strong></td> <td>0.737 ± 0.082</td> <td>21.220 ± 11.963</td> </tr> </table> <h3 id="results-of-different-initializations-and-atlas-integration-points">Results of Different Initializations and Atlas Integration Points</h3> <table border="1"> <tr> <th>Initialization</th> <th>Atlas Integration</th> <th>CSF (Dice: mean ± std)</th> <th>WM (Dice: mean ± std)</th> <th>GM (Dice: mean ± std)</th> <th>BA (mean ± std)</th> <th>Time [s] (mean ± std)</th> </tr> <tr> <td rowspan="2">Best initialization*</td> <td>After</td> <td><strong>0.729 ± 0.092</strong></td> <td>0.935 ± 0.013</td> <td>0.883 ± 0.026</td> <td><strong>0.870 ± 0.047</strong></td> <td>16.5 ± 14.2</td> </tr> <tr> <td>Into</td> <td>0.623 ± 0.139</td> <td><strong>0.948 ± 0.010</strong></td> <td><strong>0.920 ± 0.014</strong></td> <td>0.830 ± 0.044</td> <td>29.9 ± 23.0</td> </tr> <tr> <td rowspan="2">Tissue Model &amp; Probabilistic Atlas</td> <td>After</td> <td>0.354 ± 0.282</td> <td>0.850 ± 0.108</td> <td>0.848 ± 0.049</td> <td>0.756 ± 0.068</td> <td>21.4 ± 18.1</td> </tr> <tr> <td>Into</td> <td>0.337 ± 0.252</td> <td>0.876 ± 0.066</td> <td>0.661 ± 0.332</td> <td>0.625 ± 0.123</td> <td><strong>11.5 ± 6.0</strong></td> </tr> <tr> <td>MNI Atlas &amp; Best Initialization*</td> <td>Into</td> <td>0.374 ± 0.152</td> <td>0.884 ± 0.017</td> <td>0.792 ± 0.040</td> <td>0.756 ± 0.068</td> <td>29.9 ± 23.0</td> </tr> </table> <p><em>*Best initialization refers to the “Tissue Model” method in this context.</em></p> <p>In addition, some qualitative results are presented. In Figure 2 we can observe an example of the different segmentations techniques presented in this project. Additionally, the Figure 3 represents a visual comparison of the segmentation obtained by the best approach using our atlas, and the segmentation obtained using the MNI atlas.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/projectImages/atlasSegmentation/results-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/projectImages/atlasSegmentation/results-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/projectImages/atlasSegmentation/results-1400.webp"></source> <img src="/assets/projectImages/atlasSegmentation/results.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="results" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 2: Example of the different results obtained in this project. A) Original Image B) GT C) Tissue Models Segmentation D) Probabilistic Atlas Segmentation E) Combination of C and D F) KMeans Initialization for GMM G) Tissue Models Initialization for GMM H) Probabilistic Atlas Initialization for GMM I) Best Approach (Tissue Models) including Probabilistic Atlas Into GMM algorithm J) Best Approach (Tissue Models) including Probabilistic Atlas After EM algorithm K) Tissue Model &amp; Propabalistic Atlas Initialization For GMM including Probabilistic Atlas After GMM algorithm L) Tissue Model &amp; Propabalistic Atlas Initialization for GMM including Probabilistic Atlas Into GMM algorithm </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/projectImages/atlasSegmentation/MNI-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/projectImages/atlasSegmentation/MNI-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/projectImages/atlasSegmentation/MNI-1400.webp"></source> <img src="/assets/projectImages/atlasSegmentation/MNI.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="MNI" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Fig. 3: Example of the segmentation by employing the MNI atlas. A) Original Image, B) Ground Truth, C) Best segmentation by employing our atlas, D) MNI segmentation </div> <h2 id="conclusion">Conclusion</h2> <p>In this study, we explored various brain tissue segmentation techniques, focusing on the integration of probabilistic atlases and tissue models. Our experiments revealed that combining these two methods significantly enhances the accuracy of segmentation, as evidenced by the improved dice scores. The standout finding was the superior performance of the tissue model, both as a standalone approach and when used in conjunction with the probabilistic atlas.</p> <p>Further, we observed that the timing of atlas integration plays a crucial role in the segmentation process. The integration of the probabilistic atlas post-GMM computation emerged as the most effective strategy, suggesting a nuanced interplay between atlas information and GMM initialization. These insights pave the way for more sophisticated approaches in medical imaging analysis.</p> <p>Moving forward, we aim to incorporate these findings into a deep learning framework. We believe that leveraging the strengths of both traditional and modern techniques will revolutionize the accuracy and efficiency of brain tissue segmentation. The potential for improved diagnostic tools and treatment strategies in neurology is immense, and our study marks a significant step toward realizing this goal.</p> </article> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Frederik Hartmann. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>