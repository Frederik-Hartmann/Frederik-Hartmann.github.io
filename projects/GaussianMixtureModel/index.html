<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Brain Tissue Segmentation | Frederik Hartmann</title> <meta name="author" content="Frederik Hartmann"> <meta name="description" content="Expectation Maximization with a Gaussian Mixture Model"> <meta name="keywords" content="Frederik, Hartmann"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://frederik-hartmann.github.io/projects/GaussianMixtureModel/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Frederik </span>Hartmann</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Brain Tissue Segmentation</h1> <p class="post-description">Expectation Maximization with a Gaussian Mixture Model</p> </header> <article> <h1 id="brain-tissue-segmentation-using-an-expectation-maximization-em-algorithm-for-gaussian-mixture-models-gmm">Brain tissue segmentation using an Expectation Maximization (EM) algorithm for Gaussian Mixture Models (GMM)</h1> <hr> <p>Authors: <a href="https://github.com/Frederik-Hartmann" rel="external nofollow noopener" target="_blank">Frederik Hartmann</a>, <a href="https://xavibeltranurbano.github.io/" rel="external nofollow noopener" target="_blank">Xavier Beltran Urbano</a> <br> Code: <a href="">Github</a></p> <p><em>This project was carried out within the scope of the Medical Image Segmentation course taught by <a href="http://atc.udg.edu/~llado/" rel="external nofollow noopener" target="_blank">Prof. Dr. Xavier Lladó</a>. You can reach a more mathematical report <a href="">here</a>.</em></p> <p>October 2023</p> <hr> <hr> <h2 id="dataset">Dataset</h2> <p>The segmentation process was conducted using a multimodal dataset comprising 5 MRI images, each with the following modalities:</p> <ul> <li>T1-weighted (T1)</li> <li>FLAIR-weighted (FLAIR)</li> <li>Ground Truth (GT)</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/projectImages/GMM/dataset-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/projectImages/GMM/dataset-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/projectImages/GMM/dataset-1400.webp"></source> <img src="/assets/projectImages/GMM/dataset.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="dataset" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example of the different modalities of the dataset. A) T1 B) FLAIR C) GT </div> <h2 id="methodology">Methodology</h2> <p>Our approach utilizes the EM algorithm in two primary steps:</p> <ol> <li> <strong>Expectation Step</strong>: Here, we assign a membership weight to each voxel, indicating the likelihood of it belonging to a particular tissue cluster.</li> <li> <strong>Maximization Step</strong>: In this step, we update the parameters of our Gaussian models — means, covariances, and mixture weights — based on the current membership assignments.</li> </ol> <p>The model initializes with either random parameters or using KMeans clustering for a more informed starting point. The iterative process of expectation and maximization continues until convergence is achieved, indicated by the log-likelihood reaching a plateau.</p> <h2 id="results">Results</h2> <p>The algorithm’s effectiveness was quantitatively evaluated using the Dice Score (DSC), a metric that computes the similarity between predicted and ground truth segmentations. Tables 1 and 2 present the algorithm’s performance metrics alongside comparisons with other segmentation tools.</p> <p align="center"> <strong>Table 1: Evaluation results of the Expectation Maximization Algorithm on the test set</strong> </p> <table> <thead> <tr> <th>Initialization</th> <th>Modalities</th> <th>GM [DSC]</th> <th>WM [DSC]</th> <th>CSF [DSC]</th> <th>Iterations</th> <th>Time [s]</th> </tr> </thead> <tbody> <tr> <td>KMeans</td> <td>T1</td> <td>0.8457 ± 0.0436</td> <td>0.8015 ± 0.0300</td> <td>0.8120 ± 0.0251</td> <td>116 ± 4</td> <td><strong>24.36 ± 1.28</strong></td> </tr> <tr> <td>KMeans</td> <td>T1+FLAIR</td> <td>0.8457 ± 0.0436</td> <td><strong>0.8017 ± 0.0304</strong></td> <td><strong>0.8129 ± 0.0249</strong></td> <td><strong>110 ± 17</strong></td> <td>51.48 ± 8.10</td> </tr> <tr> <td>Random</td> <td>T1</td> <td>0.8025 ± 0.0819</td> <td>0.7284 ± 0.1383</td> <td>0.7860 ± 0.0670</td> <td>346 ± 108</td> <td>65.87 ± 18.42</td> </tr> <tr> <td>Random</td> <td>T1+FLAIR</td> <td><strong>0.8468 ± 0.0450</strong></td> <td>0.7978 ± 0.0233</td> <td>0.8082 ± 0.0278</td> <td>333 ± 117</td> <td>147.71 ± 51.16</td> </tr> </tbody> </table> <p align="center"> <strong>Table 2: Evaluation results of KMeans and SPM</strong> </p> <table> <thead> <tr> <th>Method</th> <th>Initialization</th> <th>Modalities</th> <th>GM [DSC]</th> <th>WM [DSC]</th> <th>CSF [DSC]</th> <th>Time [s]</th> </tr> </thead> <tbody> <tr> <td>K-means</td> <td>K-means ++</td> <td>T1</td> <td>0.8222 ± 0.0356</td> <td>0.7464 ± 0.0338</td> <td>0.8542 ± 0.0078</td> <td>3.57 ± 0.12</td> </tr> <tr> <td>K-means</td> <td>K-means ++</td> <td>T1+FLAIR</td> <td><strong>0.8243 ± 0.0357</strong></td> <td><strong>0.7500 ± 0.0315</strong></td> <td><strong>0.8560 ± 0.0071</strong></td> <td><strong>3.61 ± 0.19</strong></td> </tr> <tr> <td>SPM</td> <td>-</td> <td>T1</td> <td><strong>0.75 ± 0.03</strong></td> <td><strong>0.81 ± 0.03</strong></td> <td><strong>0.76 ± 0.02</strong></td> <td>-</td> </tr> </tbody> </table> <h2 id="conclusion">Conclusion</h2> <p>In conclusion, the application of the Expectation Maximization algorithm with Gaussian Mixture Models has proven to be an effective strategy for the segmentation of brain tissues in MRI images. Our methodology not only aligns with the stringent requirements of medical image processing but also showcases the potential to facilitate early diagnosis and treatment planning for neurodegenerative diseases.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Frederik Hartmann. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>