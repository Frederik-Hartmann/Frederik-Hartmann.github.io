<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>A new brain atlas | Frederik Hartmann</title> <meta name="author" content="Frederik Hartmann"> <meta name="description" content="Deep learning ensemble for brain tissue segmentation"> <meta name="keywords" content="Frederik, Hartmann"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://frederik-hartmann.github.io/projects/DL_brain_seg/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Frederik </span>Hartmann</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">A new brain atlas</h1> <p class="post-description">Deep learning ensemble for brain tissue segmentation</p> </header> <article> <hr> <p>Authors: <a href="https://github.com/Frederik-Hartmann" rel="external nofollow noopener" target="_blank">Frederik Hartmann</a>, <a href="https://xavibeltranurbano.github.io/" rel="external nofollow noopener" target="_blank">Xavier Beltran Urbano</a> <br> Code: <a href="https://github.com/Frederik-Hartmann/DL-Ensemble-Brain-Tissue-Segmentation" rel="external nofollow noopener" target="_blank">Github</a> <br> Report: <a href="https://github.com/Frederik-Hartmann/DL-Ensemble-Brain-Tissue-Segmentation/blob/main/Manuscript/Report.pdf" rel="external nofollow noopener" target="_blank">Github</a></p> <p>*This project was carried out within the scope of the Medical Image Segmentation course taught by <a href="http://atc.udg.edu/~llado/" rel="external nofollow noopener" target="_blank">Prof. Dr. Xavier Lladó</a>.</p> <p>December 2023</p> <hr> <hr> <h2 id="dataset">Dataset</h2> <p>The dataset used in this study is the IBSR18, containing 18 T1-weighted scans of normal subjects from the Internet Brain Segmentation Repository (IBSR). It includes preprocessed scans with a 1.5 mm slice thickness and ground truth segmentation for white matter (WM), gray matter (GM), and cerebrospinal fluid (CSF).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/projectImages/DL_brain_seg/ISBR18_Dataset-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/projectImages/DL_brain_seg/ISBR18_Dataset-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/projectImages/DL_brain_seg/ISBR18_Dataset-1400.webp"></source> <img src="/assets/projectImages/DL_brain_seg/ISBR18_Dataset.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Example of the IBSR18 Dataset" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example of the IBSR18 Dataset </div> <h2 id="methodology">Methodology</h2> <p>Our approach can be divided into 2 sections:</p> <h3 id="-preprocessing">· Preprocessing</h3> <p>First, normalization was implemented using a robust z-normalization technique, chosen due to the non-Gaussian distribution and the presence of outliers in some data. This involves adjusting the intensity values by subtracting the mean (calculated using the 25th and 75th quantiles) and dividing by the standard deviation, calculated over the same quantile range. Additionally, data augmentation was performed through random flips and rotations of the original images to enhance algorithm reliability. Finally, selective slice selection was employed for multi-class segmentation, prioritizing slices containing cerebrospinal fluid (CSF) to address class imbalance.</p> <h3 id="-training">· Training</h3> <p>For the training of this approach, several architectures, such as U-Net, Res-U-Net, Dense-U-Net, and SegResNet, have been used. We have also investigated the effect of utilizing distinct image planes (axial and coronal). Additionally, both 2D and 3D approaches have been analyzed. In Table 1, you can observe all the networks that we have trained independently. After the single trainings, we have ensembled the networks in different configurations (see Table 2).</p> <h2 id="results">Results</h2> <p>Both quantitative and qualitative results are presented in this section. They are as follows:</p> <h3 id="-quantitative-results">· Quantitative Results</h3> <p>In the following tables, we can observe the results obtained for the single trainings and the different ensemble methods carried out in this project. The metrics utilized to evaluate the segmentations are the Dice Coefficient (DSC) and the Hausdorff Distance (HD).</p> <h4 id="single-model-results">Single Model Results</h4> <table border="1" align="center"> <caption><em>Table 1: Single model results on the validation set.</em></caption> <tr> <th>Model</th> <th>CSF Dice</th> <th>GM Dice</th> <th>WM Dice</th> <th>Mean Dice</th> <th>CSF HD</th> <th>GM HD</th> <th>WM HD</th> <th>Mean HD</th> </tr> <tr> <td>2D Coronal U-Net</td> <td>0.878</td> <td>0.937</td> <td>0.933</td> <td>0.917</td> <td>39.352</td> <td>11.344</td> <td>10.443</td> <td>20.380</td> </tr> <tr> <td>2D Coronal Dense U-Net</td> <td><strong>0.899</strong></td> <td>0.937</td> <td>0.938</td> <td>0.925</td> <td>17.168</td> <td>12.199</td> <td><strong>8.149</strong></td> <td>12.502</td> </tr> <tr> <td>2D Coronal Multi-U-Net</td> <td>0.890</td> <td>0.935</td> <td>0.936</td> <td>0.920</td> <td>26.234</td> <td>13.391</td> <td>8.422</td> <td>16.016</td> </tr> <tr> <td>2D Coronal Res-U-Net</td> <td>0.882</td> <td>0.931</td> <td>0.931</td> <td>0.915</td> <td>21.894</td> <td>12.000</td> <td>10.905</td> <td>14.933</td> </tr> <tr> <td>2D Axial U-Net</td> <td>0.868</td> <td>0.929</td> <td>0.922</td> <td>0.906</td> <td>26.598</td> <td>9.876</td> <td>9.887</td> <td>15.454</td> </tr> <tr> <td>2D Axial Dense-U-Net</td> <td>0.868</td> <td>0.920</td> <td>0.920</td> <td>0.902</td> <td>27.137</td> <td>11.281</td> <td>10.580</td> <td>16.333</td> </tr> <tr> <td>2D Axial Multi-U-Net</td> <td>0.876</td> <td>0.923</td> <td>0.926</td> <td>0.908</td> <td>30.938</td> <td>10.546</td> <td>9.872</td> <td>17.119</td> </tr> <tr> <td>2D Axial Res-U-Net</td> <td>0.866</td> <td>0.925</td> <td>0.921</td> <td>0.904</td> <td>23.733</td> <td>21.277</td> <td>10.113</td> <td>18.375</td> </tr> <tr> <td>2D Seg-Res-Net</td> <td>0.877</td> <td>0.933</td> <td>0.935</td> <td>0.915</td> <td><strong>13.540</strong></td> <td>9.977</td> <td>9.449</td> <td><strong>10.989</strong></td> </tr> <tr> <td>3D U-Net</td> <td>0.882</td> <td><strong>0.942</strong></td> <td><strong>0.942</strong></td> <td><strong>0.922</strong></td> <td>16.202</td> <td>12.864</td> <td>11.574</td> <td>13.486</td> </tr> <tr> <td>3D Seg-Res-Net</td> <td>0.888</td> <td>0.935</td> <td>0.937</td> <td>0.921</td> <td>15.198</td> <td>10.367</td> <td>9.541</td> <td>11.702</td> </tr> <tr> <td>SynthSeg</td> <td>0.812</td> <td>0.829</td> <td>0.888</td> <td>0.843</td> <td>29.822</td> <td><strong>8.353</strong></td> <td>12.066</td> <td>16.747</td> </tr> </table> <h4 id="ensemble-results">Ensemble Results</h4> <table border="1" align="center"> <caption><em>Table 2: Ensemble results on the validation set.</em></caption> <tr> <th>Model</th> <th>CSF Dice</th> <th>GM Dice</th> <th>WM Dice</th> <th>Mean Dice</th> <th>CSF HD</th> <th>GM HD</th> <th>WM HD</th> <th>Mean HD</th> </tr> <tr> <td>The Coronal Ensemble Mean</td> <td>0.895</td> <td>0.939</td> <td>0.939</td> <td>0.925</td> <td>18.508</td> <td>9.630</td> <td>7.783</td> <td>11.974</td> </tr> <tr> <td>The Coronal Ensemble Maximum</td> <td>0.893</td> <td>0.939</td> <td>0.939</td> <td>0.923</td> <td>23.860</td> <td>9.811</td> <td>8.843</td> <td>14.171</td> </tr> <tr> <td>The Coronal Ensemble Majority</td> <td>0.890</td> <td>0.939</td> <td>0.937</td> <td>0.922</td> <td>19.123</td> <td>11.465</td> <td>7.564</td> <td>12.717</td> </tr> <tr> <td>The Axial Ensemble Mean</td> <td>0.884</td> <td>0.930</td> <td>0.928</td> <td>0.914</td> <td>17.121</td> <td>10.704</td> <td>9.127</td> <td>12.317</td> </tr> <tr> <td>The Axial Ensemble Maximum</td> <td>0.881</td> <td>0.930</td> <td>0.927</td> <td>0.913</td> <td>23.055</td> <td>10.655</td> <td>9.782</td> <td>14.498</td> </tr> <tr> <td>The Axial Ensemble Majority</td> <td>0.877</td> <td>0.930</td> <td>0.925</td> <td>0.911</td> <td>22.114</td> <td>10.946</td> <td>9.277</td> <td>14.112</td> </tr> <tr> <td>The Coronal + Axial Mean</td> <td>0.897</td> <td>0.939</td> <td>0.938</td> <td>0.925</td> <td>16.410</td> <td>8.902</td> <td>9.095</td> <td>11.469</td> </tr> <tr> <td>The Coronal + Axial Maximum</td> <td>0.893</td> <td>0.938</td> <td>0.937</td> <td>0.923</td> <td>21.901</td> <td>10.270</td> <td>9.370</td> <td>13.847</td> </tr> <tr> <td>The Coronal + Axial Majority</td> <td>0.894</td> <td>0.940</td> <td>0.938</td> <td>0.924</td> <td>16.611</td> <td>9.811</td> <td>8.653</td> <td>11.692</td> </tr> <tr> <td>The Multidimensional Ensemble Mean</td> <td><strong>0.904</strong></td> <td><strong>0.945</strong></td> <td><strong>0.948</strong></td> <td><strong>0.932</strong></td> <td><strong>11.918</strong></td> <td><strong>8.730</strong></td> <td><strong>7.660</strong></td> <td><strong>9.436</strong></td> </tr> </table> <h3 id="-qualitative-results">· Qualitative Results</h3> <p>Here, an example of the segmentation obtained from the ensemble with the best performance (the Multidimensional Ensemble Mean) is presented in Fig 2.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/projectImages/DL_brain_seg/Result-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/projectImages/DL_brain_seg/Result-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/projectImages/DL_brain_seg/Result-1400.webp"></source> <img src="/assets/projectImages/DL_brain_seg/Result.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Results on the IBSR18 Dataset" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Comparison of segmentation results of the best-performing ensemble: The Multidimensional Ensemble. Displayed are axial slices (left), sagittal slices (middle), and coronal slices (right)</div> <h2 id="conclusion">Conclusion</h2> <p>The study clearly illustrates the efficacy of an ensemble methodology that synergizes 2D and 3D convolutional neural networks (CNNs) for segmenting brain tissue. This innovative approach benefits significantly from leveraging various orientations of 2D slices in combination with both 2D and 3D models. Among the various techniques explored, the ensemble method, especially the mean of probabilities technique, stands out for its exceptional robustness and precision in results. Future scope would include working on dealing with the imbalance problem since, even after obtaining excellent performance for all tissues, it can be appreciated that the results obtained for CSF are slightly lower than the WM and GM ones.</p> </article> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Frederik Hartmann. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>